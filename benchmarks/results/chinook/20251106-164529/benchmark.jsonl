{"id": "Q1", "question": "list all customers with their country", "sql_gold": "SELECT CustomerId, FirstName, LastName, Country FROM customers ORDER BY CustomerId;", "sql_pred": "SELECT CustomerId, FirstName, LastName, Country FROM customers ORDER BY CustomerId;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 10.0, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 2, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 1, "summary": "ok", "notes": {"row_count": 4, "col_count": 4}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 83, "new_sql_len": 83}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 1, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 4}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 83, "new_sql_len": 83}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 1, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 1, "summary": "ok", "notes": {"row_count": 4, "col_count": 4}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
{"id": "Q2", "question": "show total invoice amount per billing country", "sql_gold": "SELECT BillingCountry, SUM(Total) AS total_revenue FROM invoices GROUP BY BillingCountry ORDER BY total_revenue DESC;", "sql_pred": "SELECT BillingCountry, SUM(Total) AS total_revenue FROM invoices GROUP BY BillingCountry ORDER BY total_revenue DESC;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 11.22, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 1, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 117, "new_sql_len": 117}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 2, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 1, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 117, "new_sql_len": 117}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 2, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 1, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
{"id": "Q3", "question": "show three albums with the highest sales amount", "sql_gold": "SELECT a.Title, SUM(ii.Quantity * ii.UnitPrice) AS total_sales FROM albums a JOIN tracks t ON a.AlbumId = t.AlbumId JOIN invoice_items ii ON t.TrackId = ii.TrackId GROUP BY a.AlbumId ORDER BY total_sales DESC LIMIT 3;", "sql_pred": "SELECT a.Title, SUM(ii.Quantity * ii.UnitPrice) AS total_sales FROM albums a JOIN tracks t ON a.AlbumId = t.AlbumId JOIN invoice_items ii ON t.TrackId = ii.TrackId GROUP BY a.AlbumId ORDER BY total_sales DESC LIMIT 3;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 15.59, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 4, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 1, "summary": "ok", "notes": {"row_count": 3, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 217, "new_sql_len": 217}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 4, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 3, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 217, "new_sql_len": 217}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 4, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 3, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
{"id": "Q4", "question": "artists who released more than one album", "sql_gold": "SELECT ar.Name, COUNT(*) AS album_count FROM artists ar JOIN albums al ON ar.ArtistId = al.ArtistId GROUP BY ar.ArtistId HAVING COUNT(*) > 1 ORDER BY album_count DESC;", "sql_pred": "SELECT ar.Name, COUNT(*) AS album_count FROM artists ar JOIN albums al ON ar.ArtistId = al.ArtistId GROUP BY ar.ArtistId HAVING COUNT(*) > 1 ORDER BY album_count DESC;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 12.27, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 3, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 1, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 167, "new_sql_len": 167}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 3, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 1, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 167, "new_sql_len": 167}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 3, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 1, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
{"id": "Q5", "question": "number of employees per city", "sql_gold": "SELECT City, COUNT(*) AS employees FROM employees GROUP BY City ORDER BY employees DESC;", "sql_pred": "SELECT City, COUNT(*) AS employees FROM employees GROUP BY City ORDER BY employees DESC;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 6.87, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 1, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 3, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 88, "new_sql_len": 88}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 1, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 3, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 88, "new_sql_len": 88}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 1, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 3, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
{"id": "Q6", "question": "average invoice total for each customer", "sql_gold": "SELECT c.FirstName || ' ' || c.LastName AS customer_name, AVG(i.Total) AS avg_invoice_total FROM customers c JOIN invoices i ON c.CustomerId = i.CustomerId GROUP BY c.CustomerId ORDER BY avg_invoice_total DESC;", "sql_pred": "SELECT c.FirstName || ' ' || c.LastName AS customer_name, AVG(i.Total) AS avg_invoice_total FROM customers c JOIN invoices i ON c.CustomerId = i.CustomerId GROUP BY c.CustomerId ORDER BY avg_invoice_total DESC;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 10.66, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 2, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 210, "new_sql_len": 210}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 3, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 210, "new_sql_len": 210}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 2, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
{"id": "Q7", "question": "total quantity of tracks sold by album", "sql_gold": "SELECT a.Title, SUM(ii.Quantity) AS units_sold FROM albums a JOIN tracks t ON a.AlbumId = t.AlbumId JOIN invoice_items ii ON t.TrackId = ii.TrackId GROUP BY a.AlbumId ORDER BY units_sold DESC;", "sql_pred": "SELECT a.Title, SUM(ii.Quantity) AS units_sold FROM albums a JOIN tracks t ON a.AlbumId = t.AlbumId JOIN invoice_items ii ON t.TrackId = ii.TrackId GROUP BY a.AlbumId ORDER BY units_sold DESC;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 12.84, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 4, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 192, "new_sql_len": 192}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 3, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 192, "new_sql_len": 192}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 2, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 4, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
{"id": "Q8", "question": "customers with more than two invoices", "sql_gold": "SELECT c.FirstName || ' ' || c.LastName AS customer_name, COUNT(*) AS invoice_count FROM customers c JOIN invoices i ON c.CustomerId = i.CustomerId GROUP BY c.CustomerId HAVING COUNT(*) > 2 ORDER BY invoice_count DESC;", "sql_pred": "SELECT c.FirstName || ' ' || c.LastName AS customer_name, COUNT(*) AS invoice_count FROM customers c JOIN invoices i ON c.CustomerId = i.CustomerId GROUP BY c.CustomerId HAVING COUNT(*) > 2 ORDER BY invoice_count DESC;", "em": true, "structural_match": true, "execution_accuracy": true, "latency_ms": 12.66, "cost_usd": 0.0, "ok": true, "error": null, "traces": [{"stage": "detector", "duration_ms": 0, "summary": "clear", "notes": {"ambiguous": false, "questions_len": 0}}, {"stage": "planner", "duration_ms": 0, "summary": "ok", "notes": {"len_plan": 106}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "generator", "duration_ms": 0, "summary": "ok", "notes": {"rationale_len": 60}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 3, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 1, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 218, "new_sql_len": 218}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 3, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 1, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "repair", "duration_ms": 0, "summary": "ok", "notes": {"old_sql_len": 218, "new_sql_len": 218}, "token_in": 0, "token_out": 0, "cost_usd": 0.0}, {"stage": "safety", "duration_ms": 4, "summary": "ok", "notes": {}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "executor", "duration_ms": 0, "summary": "ok", "notes": {"row_count": 1, "col_count": 2}, "token_in": null, "token_out": null, "cost_usd": null}, {"stage": "pipeline", "duration_ms": 0, "summary": "auto-verified", "notes": {"reason": "executor succeeded, verifier silent"}}, {"stage": "pipeline", "duration_ms": 0, "summary": "finalize", "notes": {"final_verified": true, "details_len": 0}}]}
