name: Proxy Secrets Smoke Test

on:
  workflow_dispatch: {}

jobs:
  check-proxy-secrets:
    runs-on: ubuntu-latest
    env:
      PROXY_API_KEY: ${{ secrets.PROXY_API_KEY }}
      PROXY_BASE_URL: ${{ secrets.PROXY_BASE_URL }}

    steps:
      - name: ðŸ§¾ Check runner environment
        run: |
          echo "Python version:"
          python3 --version
          echo "GitHub runner ready."

      - name: ðŸ” Verify secrets presence
        run: |
          set -e
          if [ -z "$PROXY_API_KEY" ]; then
            echo "âŒ PROXY_API_KEY missing" >&2
            exit 1
          fi
          if [ -z "$PROXY_BASE_URL" ]; then
            echo "âŒ PROXY_BASE_URL missing" >&2
            exit 1
          fi
          echo "âœ… Both secrets are present."

      - name: ðŸ§ª Validate secrets accessibility (Python)
        run: |
          python3 - << 'PY'
          import os
          key = os.getenv("PROXY_API_KEY")
          url = os.getenv("PROXY_BASE_URL")
          assert key, "PROXY_API_KEY missing"
          assert url, "PROXY_BASE_URL missing"
          print(f"Python can access both secrets âœ… (key len={len(key)}, base={url})")
          PY
